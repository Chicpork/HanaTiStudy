# SQL 및 SQL-Plus

## SQL 개요

* SQL (Structured Query Language)
  * 구조적 질의 언어
  * 관계형 데이터베이스 관리시스템(RDBMS)의 데이터베이스에 데이터를 저장하거나 조회, 수정, 삭제(CRUD)할 수 있도록 고안된 구조적 표준 질의 언어이다.
  * SQL을 이용해 사용자나 프로그램에서 데이터베이스 관리시스템에 접근할 수 있다.
  * SQL은 어떻게 작업을 수행할 것인가 보다는 무슨 데이터를 추출하고 변경할 것인가를 서술하는 비절차적인 프로그래밍 언어이다.
  * ISO(International Standardization Organization : 국제 표준화 기구)에서 관계형 데이터베이스관리시스템(RDBMS)의 표준 질의 언어로 채택
  * SQL 표준에 맞춰 제작된 대부분의 DBMS에는 데이터타입과 내장 함수의 차이만 있을 뿐 SQL 기본 문법(명령어)은 동일하다.
* ![1537143118392](image/sqlex.png)



### SQL 특징

* 데이터베이스 기본 데이터 저장 단위인 테이블과 테이블간의 관계를 이용한다.
* SQL은 입력 테이블로부터 원하는 출력 데이터를 매핑 시키는 언어이다.
* 관계형 DBMS는 데이터베이스로 물리적 파일을 사용한다.
  * 사용자나 애플리케이션이 파일을 직접 접근하는 것이 아니라, DBMS와의 SQL을 통신을 통해 Database의 데이터를 조회하거나 수정, 삭제, 저장한다.
* Cobol, C, Visual Basic, Delphi, C++, Java 등의 프로그램 언어로 작성된 코드에 SQL문을 내장(Embed)하여 Database 연동 애플리케이션(시스템)을 개발할 수 있다.
  * 자바에서 바로 오라클에 접근해 이용할 수 없다.
* SQL은 모든 RDBMS 제품(Oracle, MySQL, MarioDB, Sybase, Informix, DB2 등)에서 채택한 표준 질의 언어이다.



### 관계형 데이터베이스(RDB) 기본 용어
#### 테이블(Table)

![1537143419068](image/table.png)

* 관계형 데이터베이스의 기본 데이터 저장 단위로 시스템에서 저장되길 원하는 현실세계의 엔티티(Entity)를 표현한다.
  * 엔티티는 자바에서 객체를 클래스로 표현하는 것처럼 현실세계의 데이터를 SQL에서 엔티티라고 한다.
* 테이블은 여러 개의 행(Row)와 열(Column)으로 구성되며, 행은 데이터를  처리하는 기본 단위가 된다.
* 자바 언어의 객체(Object) vs Entity,  Class vs Table, Instance vs Row,  Attribute vs Column으로 비유할 수 있다.



#### 테이블간의 관계

![1537143720352](image/table3.png)

* 데이터베이스는 여러 테이블간의 관계로 표현 될 수 있다.
* SQL에서는 기본키(Primary Key)와 왜리키(Foreign Key)를 이용하여 테이블간의 관계를 표현한다.
* 까마귀 다리 표시처럼 되어 있는 하늘색 선은 프라이머리 치와 Foreing Key의 관계를 표현하기 위해 사용한 것이다
  * 하나의 부서에 여러 사원이 존재할 수 있다는 것을 표현하기 위해 다리가 여러개인 줄을 사용한다.
* 정규화
  * 자바에서 클래스들을 캡슐화시키는 것처럼 데이터들도 하나에 모으지 않고 잘게잘게 쪼개 저장하는 것을 정규화라고 한다.
  * 이렇게 하면 유지보수가 편하다.



### SQL 종류

![1537144086872](image/sqltype.png)



### SQL 작성 규칙

![1537144369426](image/sqlrule.png)

* SQL은 대소문자를 구별하지 않지만 **키워드**는 대문자를 사용하도록 권장
* 식별자(테이블명, 컬럼명 등)은 소문자를 사용하도록 권장
* 하나의 SQL 명령문은 여러 줄에 걸쳐 입력할 수 있음
  * 입력하다 엔터를 누르면 자동으로 넘어간다.
  * 각 절은 되도록 다른 행에 작성하는게 가독성이 좋고, 수정이 용이하여 좋다.
* 모든 명령문을 입력했을 시는 명령문 종료를 위해 세미콜론(;)을 사용한다.
* 문자(열) 리터럴은 작은 따옴표( ' ' )로 묶어 사용한다.
  * 자바와 다르게 문자와 문자열을 다르게 구분하지 않고 둘다 작은 따옴표를 사용한다.



## SQL Plus

- SQL Plus
  - SQL이 언어라면 플러스는 서버와 통신하기 위한 프로그램이라고 생각해도 된다. cmd 창을 통해 이용한다.
  - 한마디로 도구이다.

- SQL Plus를 사용할 때 SQL 명령어도 있지만 SQL Plus 명령어도 존재한다.
  - 이 둘을 잘 구별해 사용하는 것이 중요하다.
  - 우리가 처음 플러스를 사용할 때 사용하는 connect 명령어는 플러스 명령어이다.
  - 보통 SQL Plus 명령어는 축약이 가능하다.



### SQL Plus 명령어

![1537146632036](image/sqlplusplus.png)

* EDIT
  * 메모리에 불러왔던 정보 중 몇가지 정보를 다시 보고 싶을 때 사용한다.
  * edit 하고 엔터를 입력하면 내가 불러왔던 명령어를 볼 수 있고 이걸 수정하면 된다.
  * 수정 한 후 RUN을 실행하면 바뀐 결과를 확인할 수 있다.
  * ED 로 사용할 수 있다.
* HOST
  * 운영체제로 빠져 나가는데 사용한다.
  * 이건 SQL에 화면 전체에 나온 내용을 지워주는 cls와 같은 기능이 없는데 이를 사용하기 위해 운영체제로 나가는 것이다.
  * HOST를 한 뒤 cls 를 통해 ㅗ하면을 클리어한 뒤 다시 EXIT를 하면 원래 SQL로 돌아 온다.
* SAVE
  * 메모리 버퍼에 있던 마지막 명령어가 저장된다.
  * `SAVE c:\KOSTA187\test.sql.` 입력시 우리가 사용한 명령어가 해당 위치에 저장될 것이다.
* GET
  * 위에서 저장한 sql 파일을 읽어온다.
  * 하지만 출력은 하지 않는다.
* START
  * GET 기능에 실행까지 해주는 명령어이다.
  * 이때 @로도 사용 가능하다.
  * `@ 경로`를 통해 읽어서 실행까지 할 수 있다.
* SPOOL
  * 이 명령어를 통해 이 명령어를 사용한 이후 사용한 모든 명령어들과 결과들을 저장할 수 있다.
  * SAVE가 마지막 명령어들만을 저장하는 것과는 다르다.
  * `SPOOL 경로`로 사용하고 `SPOOL OFF`를 통해 어디까지 저장할 지 정할 수 있다.

![1537146737577](image/sqlplusplus2.png)



### Describe 명령어

![1537144923332](image/sqlplus.png)

* Null? 은 무결성 검사라고 무조건 입력되어 있어야 하는 값들이다.
* Type에서 NUMBER(숫자1, 숫자2) 은 어떤 형식이든 숫자를 저장할 때 사용한다.
  * 정수든 실수든 상관 없다.
  * 숫자1은 숫자의 자리수이고 숫자2는 소수점 자리수이다.
  * 이때 숫자1은 콤마도 포함한다.
* Type에서 VARCHAR2(숫자) 는 숫자만큼의 바이트를 최대 크기로 가지는 문자열을 받은 뒤 이것보다 조금 저장되면 알아서 저장 크기를 줄여 저장해준다.