# Servlet

* 서블릿은 프로토콜이 올 때 그에 해당하는 처리 과정을 만들기 위한 인터페이스이다.
* 이 인터페이스를 기준으로 각각의 프로토콜에 어떻게 동작할지 만든다.



## WAS

* Web Application Server
* 웹 서버는 단순히 정적 콘텐츠만 서비스가 가능하다
* 하지만 우린 이 안에 동적 요소들을 넣어서 사용하고 할 때 WAS를 통해 하게 된다.



## Apache Tomcat

* 설치하고 여러 설정들 하기!
* 포트 번호 수정
* URIEncoding  utf-8로 수정



## Servlet

### HTTP 요청 처리 과정

* 클라이언트로부터 `GET`요청이 온다
* 웹 서버가 이를 처리하고 못할 시 컨테이너로 디스패치(위임)한다.
* 컨테이너가 처리를 한 뒤 어떤 서블릿에 대한 요청인지 처리한다
  * 이때 요청 메시지와 응답 메시지를 저장할 2개의 객체를 생성한다.
  * request, response
* 그럼 서블릿이 메모리에 생성된다.
  * 스레드가 만들어진다.
* 이를 이용해 필요한 처리를 한뒤 내용을 컨테이너로 넘긴다
  * 이때 이 서블릿이 처음 호출되는 거면 init()이 실행되고
  * 그 다음 service()가 실행된뒤
  * 요청 방식에 따라 doGet()이나 doPost()호출된다.
* 컨테이너로 넘긴 뒤 request와 response는 삭제된다.



### MIME

* Multipurpose Internet Mail Extension

* 마임은 서로 주고 받는 파일 형식을 알려주기 위해 사용하는 것이다.



### FORM

#### METHOD

* GET
  * get 방식으로 보내면 주소창을 통해 넘어가기 때문에 주소창의 인코딩 방식으로 넘어간다.
* POST
  * post로 넘어가면 서버에서 처리를 해서 받아오기 때문에 서버에 어떤 방식으로 인코딩할지 정해주어야 한다.
* HEAD: 헤더 정보만 주고 받을 때
* PUT : 수정사항이 있을 때
* DELET : 삭제할 때
* TRACE : 에코 서버처럼 그대로 다시 보내주는





## 서블릿 컨테이너 데이터 공유

* jsp에서는 스코프 개념으로 이야기 하는 내용이다.



### ServletContext

* 서블릿들이 컨테이너에 만들어 지고 나서 서로 어디에 있는지 알 수가 없다.
* 그런데 우리는 한 서블릿에서 다른 서블릿으로 정보를 보여주거나 하고 싶을 수 있는데 이를 위해 만들어진 서블릿이 존재하고 이 안에 컨테이너에 의해 관리되는 모든 서블릿들이 공유할 수 있는 정보를 담고 있게 된다
* 우리가 어떤 정보를 보내고 싶다면 서블릿컨텍스트에 정보를 저장해 놓고 다른 서블릿에서 서블릿컨텍스트에 접근해 정보를 읽어오면 된다.
* 이 방법으로는 모든 서블릿들 간에 공유를 하게 된다.
* 하지만 동기화 문제때문에 잘 쓰지 않는다.



### Session

* 세션은 브라우저당 1개씩 생기는 영역이라고 생각해도 된다.
* 이런 이유로 접속하는 브라우저마다 세션은 각각 생성되게 된다.
* 각각의 세션은 세션 안에서만 서로 정보를 공유하게 된다.



### Request

* 브라우저가 연결될때마다 Request와 Response는 지역변수처럼 항상 생기게 된다.
* 이때 Request에 setAttribute, getAttribute를 통해 데이터를 저장하고 읽어올 수 있다.
* 하지만 이건 Response를 하게 되면 자동으로 삭제되는 객체들이기 때문에 이를 사용하기 위해선 forward를 사용해야 한다.
* 그럼 forward를 받은 서블릿이 보내준 서블릿의 request를 공유하게 되어 데이터를 서로 공유할 수 있다.



## 클라이언트 상태 정보 유지

### 세션

* HTTP는 브라우저와 서버가 연결이 되고난 뒤 연결이 바로 끊어진다.
* 이런 특징때문에 각각의 브라우저가 들어왔었는지와 같은 정보들을 저장해 놓기 어렵다.

* 세션은 서버에 각각의 브라우저(유저)에 대한 정보를 저장하기 위한 맵을 만들어 놓는 것이다.
* 이를 이용해 각각의 사용자에 대한 정보를 저장할 수 있지만 많은 사용자가 들어 올 시 문제가 될 가능성이 높다.



### 쿠키

* 세션과 다르게 서버에 클라이언트의 정보를 기록하는 것이 아니라 클라이언트에게 저장해놓는 것이 쿠키이다.
* 반드시 쿠키에 이름과 그 값을 저장해 놓아야 한다.